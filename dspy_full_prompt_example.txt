FULL DSPy PROMPT EXAMPLE
========================

This is what the model actually receives when DSPy runs. It combines:
1. The signature instructions
2. All few-shot examples
3. The specific input for this generation

---

Generate medical eConsult template optimized for COMPREHENSIVENESS and CONCISENESS with physician-validated best practices

---

Follow the following format.

Specialty: Medical specialty (e.g., cardiology, neurology, endocrinology)
Condition: Medical condition being consulted about
Reasoning: Let's think step by step in order to ${reasoning}
Template: Complete JSON template following Stanford format with physician-validated best practices:

COMPREHENSIVE CLINICAL ASSESSMENT PRINCIPLES:
1. COMPLETE LAB PANELS: Use "Complete Metabolic Panel (CMP)" not individual components. Include timing like "within last 6 months"
2. FULL MEDICATION HISTORY: "All current medications, supplements, OTC drugs with dosage, frequency, adherence, duration, recent changes"
3. THOROUGH SYMPTOMS: Include associated symptoms, severity, frequency, triggers, physical exam findings
4. BALANCED SPECIFICITY: Avoid over-narrowing (use "family history of cardiac disease" not just "MI")
5. PRACTICAL TIMEFRAMES: Include relevant timing ("within past year", "while on current therapy")

PRIORITIZE: 1) COMPREHENSIVE coverage of essential clinical elements, 2) CONCISE expression (avoid verbose >20 words), 3) Clinical utility for specialist consultation. Clinical pearls optional.

---

Specialty: rheumatology
Condition: inflammatory_back_pain
Reasoning: Let's think step by step in order to create a comprehensive template for rheumatology inflammatory back pain that captures all essential clinical information while maintaining conciseness.
Template: [
  {
    "My Clinical Question (condition: inflammatory back pain)": "***"
  },
  {
    "My most current assessment of this problem can be found in the note dated": "{Today/***}"
  },
  {
    "In your clinical question, or current note, please include information on": {
      "Assessments": {
        "Required": [
          {
            "Duration of symptoms": "***"
          },
          {
            "Age of onset": "***"
          },
          {
            "Location and radiation of pain": "***"
          },
          {
            "Pattern of pain (e.g., morning stiffness, improvement with exercise)": "***"
          },
          {
            "Associated symptoms (e.g., psoriasis, uveitis, enthesitis)": "***"
          },
          {
            "Family history of inflammatory back disease": "***"
          },
          {
            "Previous treatment for inflammatory back pain (including medications and dosages)": "***"
          },
          {
            "Current medications (including dosages and adherence)": "***"
          },
          {
            "Physical examination findings (including tenderness, swelling, range of motion)": "***"
          }
        ],
        "Optional": []
      },
      "Diagnostics": {
        "Required": [
          {
            "Complete Blood Count (CBC)": "***"
          },
          {
            "Erythrocyte Sedimentation Rate (ESR)": "***"
          },
          {
            "C-Reactive Protein (CRP)": "***"
          },
          {
            "HLA-B27": "***"
          },
          {
            "Radiographs of the spine and sacroiliac joints": "***"
          }
        ],
        "Optional": [
          {
            "Magnetic Resonance Imaging (MRI) of the spine and sacroiliac joints": "***"
          },
          {
            "Ultrasound of the spine and sacroiliac joints": "***"
          }
        ]
      }
    }
  }
]

---

Specialty: nephrology
Condition: proteinuria
Reasoning: Let's think step by step in order to create a comprehensive nephrology template for proteinuria evaluation that includes essential diagnostic workup and clinical assessments.
Template: [
  {
    "My Clinical Question (condition: proteinuria)": "***"
  },
  {
    "My most current assessment of this problem can be found in the note dated": "{Today/***}"
  },
  {
    "In your clinical question, or current note, please include information on": {
      "Assessments": {
        "Required": [],
        "Optional": [
          {
            "Does the patient exercise heavily?": "***"
          },
          {
            "Does the patient have any edema? If yes, where is the edema?": "***"
          },
          {
            "Does the patient have any known/previously diagnosed kidney disease?": "***"
          },
          {
            "Does the patient have any of the following chronic conditions: Hypertension, Diabetes mellitus, Hyperlipidemia, Chronic inflammatory condition (such as SLE or RA)": "***"
          },
          {
            "Has the patient had a recent febrile illness?": "***"
          }
        ]
      },
      "Diagnostics": {
        "Required": [
          {
            "Basic Metabolic Panel (BMP)": "***"
          },
          {
            "Kidney Ultrasound (Renal Ultrasound)": "***"
          },
          {
            "Urine Albumin": "***"
          },
          {
            "Urinalysis with Microscopy": "***"
          },
          {
            "Spot prot/creat ratio (or 24-hour urine protein and creatinine)": "***"
          },
          {
            "Complete Blood Count (CBC)": "***"
          }
        ],
        "Optional": [
          {
            "HBV": "***"
          },
          {
            "HCV": "***"
          },
          {
            "Hemoglobin A1c (HbA1c)": "***"
          },
          {
            "HIV": "***"
          },
          {
            "SPEP (If patient is at risk of monoclonal gammopathy)": "***"
          },
          {
            "UPEP (If patient is at risk of monoclonal gammopathy)": "***"
          },
          {
            "Serum free light chain ratio (If patient is at risk of monoclonal gammopathy)": "***"
          }
        ]
      }
    }
  }
]

---

[... 3 more examples ...]

---

Specialty: cardiology
Condition: atrial_fibrillation_atrial_flutter
Reasoning: Let's think step by step in order to